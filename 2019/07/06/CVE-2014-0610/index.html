<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>CVE-2014-0610 心脏滴血漏洞复现 - Naykcin's Page</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/logo.png"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li><li><a href="https://www.v2ex.com/"><span>V2EX</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="http://47.95.140.43/typora_pic/background.JPG"><div class="post-title"><h1 class="title">CVE-2014-0610 心脏滴血漏洞复现</h1><ul class="meta"><li><i class="icon icon-author"></i>Naykcin</li><li><i class="icon icon-clock"></i>2 Minutes</li><li><i class="icon icon-calendar"></i>July 6, 2019</li></ul></div></div><div class="article-content" style="max-width:800px"><h2 id="CVE-2014-0610-心脏滴血漏洞复现"><a href="#CVE-2014-0610-心脏滴血漏洞复现" class="headerlink" title="CVE-2014-0610 心脏滴血漏洞复现"></a><center>CVE-2014-0610 心脏滴血漏洞复现</center></h2><h3 id="📍-漏洞原理"><a href="#📍-漏洞原理" class="headerlink" title="📍 漏洞原理"></a>📍 漏洞原理</h3><ul>
<li><p>SSL、TLS、DTLS</p>
<p>在网络中，TCP/IP 协议层之上的安全可以由 Secure Socket Layer（SSL）及其替代协议 Transport Layer Security（TLS）进行保障。这两个协议经常被称作 SSL/TLS。HTTP 是一个无状态的应用层协议，主要用来在服务端和客户端之间传输数据。HTTPS 主要通过在 HTTP 和 TCP 层之间增加了 SSL/TLS 层来保证服务端与客户端之间安全的传输数据。</p>
<p>DTLS（Datagram Transport Layer Security）即数据包传输层安全协议，主要是试图在 TLS 协议架构上提出扩展，使之支持 UDP。</p>
<p>TLS/DTLS 中的心跳协议主要是用来检测两个设备之间是否还有连接的，根据 RFC 规定，心跳协议允许在 TLS 记录层之上，主要是通过交换「心跳」的方式，用来维持端到端之间的连接。</p>
</li>
<li><p>在 OpenSSL 1.0.1 版本中存在严重漏洞，该漏洞会导致内存越界，攻击者可以远程存读取 OpenSSL 服务器中 64K 的数据。</p>
</li>
<li><p>影响版本：OpenSSL 1.0.1等。</p>
</li>
<li><p>由于未能在 memcpy() 调用受害用户输入内容作为长度参数之前正确进行边界检查。攻击者可以追踪 OpenSSL 所分配的 64K 缓存、将超出必要范围的字节信息复制到缓存当中再返回缓存内容，这样一来受害者的内存内容就会以每次 64K 的速度进行泄漏。</p>
</li>
</ul>
<h3 id="📍-漏洞危害"><a href="#📍-漏洞危害" class="headerlink" title="📍 漏洞危害"></a>📍 漏洞危害</h3><p>可以通过该漏洞读取每次攻击泄漏出来的信息，所以可能也可以获取到服务器的私钥，用户 cookie 和密码等。</p>
<h3 id="📍-漏洞复现"><a href="#📍-漏洞复现" class="headerlink" title="📍 漏洞复现"></a>📍 漏洞复现</h3><p>已知网站 IP 为 172.16.232.204，访问结果：</p>
<p><img src="http://47.95.140.43/tu/CVE-2014-0610/%e5%b1%8f%e5%b9%95%e5%bf%ab%e7%85%a7%202019-11-06%20%e4%b8%8a%e5%8d%8811.31.17.png" alt="屏幕快照 2019-11-06 上午11.31.17"></p>
<p>用 nmap 脚本探测目标网站是否存在心脏滴血漏洞，结果表示存在：</p>
<p><img src="http://47.95.140.43/tu/CVE-2014-0610/%e5%b1%8f%e5%b9%95%e5%bf%ab%e7%85%a7%202019-11-06%20%e4%b8%8a%e5%8d%8811.34.53.png" alt="屏幕快照 2019-11-06 上午11.34.53"></p>
<p>启动 metasploit，查找 heartbleed 模块，设置目标主机地址：</p>
<p><img src="http://47.95.140.43/tu/CVE-2014-0610/image-20191106124500990.png" alt="image-20191106124500990"></p>
<p>设置 verbose，设置为 true 才能看到泄露的信息：</p>
<p><img src="http://47.95.140.43/tu/CVE-2014-0610/%e5%b1%8f%e5%b9%95%e5%bf%ab%e7%85%a7%202019-11-06%20%e4%b8%8b%e5%8d%8812.46.14.png" alt="屏幕快照 2019-11-06 下午12.46.14"></p>
<p>使用 exploit：</p>
<p><img src="http://47.95.140.43/tu/CVE-2014-0610/image-20191106124745901.png" alt="image-20191106124745901"></p>
<p>入侵者每次可以翻检户主 64K 的信息，只要有足够的耐心和时间，就可以翻检足够多的数据，拼凑出用户的各类信息，虽存在随机性，但实现方法简易快捷，可批量攻击，存在较高危险性。</p>
<h3 id="📍-漏洞升级"><a href="#📍-漏洞升级" class="headerlink" title="📍 漏洞升级"></a>📍 漏洞升级</h3><ul>
<li>建议升级 OpenSSL</li>
<li>修改服务器密码</li>
<li>重新配置私钥</li>
<li>重新配置证书</li>
</ul>
</div><div class="article-meta" style="max-width:800px"></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="ckaigj8kx0001uq90lxxkac3m" data-title="CVE-2014-0610 心脏滴血漏洞复现" data-url="https://naykcin.top/2019/07/06/CVE-2014-0610/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2019/07/09/渗透测试姿势小结/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2019/06/07/PHP文件包含漏洞复现/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/NickYan7" title="Github" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="http://47.95.140.43/tu/721580653348_.pic.jpg" title="wechat" target="_blank"><i class="icon icon-wechat"></i></a></li></ul></div><div class="bottom"><p class="copyright">© 2020 Naykcin's Page</p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>